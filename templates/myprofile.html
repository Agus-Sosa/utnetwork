<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{url_for('static',filename='css/myprofile.css')}}">
    <title>Mi perfil</title>
</head>
<body>
    <div class="container_banner">
        <img src="" alt="">
    </div>
    <div class="container_main">
        <aside class="left">
            <div class="container_profile_left">
                <picture>
                    <img src="{{usuario['avatar']}}" alt="">
                </picture>
                <h4>{{usuario['nombre']}}</h4>
                <h5>{{usuario['mail']}}</h5>
                {% if usuario['descripcion'] %}
                <p>{usuario['descripcion']}</p>
                {% else %}
                <textarea name="" id="" placeholder="agregar comentario"></textarea>
                {% endif %}
            </div>
        </aside>
        <main>
            <div class="container_publish">
                <div>
                    <picture>
                        <img src="{{usuario['avatar']}}" alt="">
                    </picture>
                    <form action="{{url_for('publicar')}}" method="POST" id="form_new_post">
                    <textarea id="input_publish" name='input_publish' type="text" placeholder="{{usuario['nombre']}}, {{pregunta}}"></textarea>
                    <div id="error_new_post" class="error_message"></div>
                </div>
                <button  type="submit">Publicar</button>
                </form>
            </div>
            <div>

            {% if publicaciones %}

            {% for publicacion in publicaciones %}
                <div class="publish_card">
                    <div class="container_profile">

                    <div class="container_info_profile">
                        
                        <picture>
                            <img src="{{ usuario['avatar'] }}" alt="">
                        </picture>
                        <div class="container_info_profile_text">
                            <p>{{usuario['nombre']}}</p>
                            <p>{{publicacion['fecha']}}</p>
                            <input name="id_publi"id="id_publi" style="display: none;" value="{{publicacion['id_publicacion']}}">

                        </div>
                    </div>

                        <div class="container_info_profile_buttons" style="display: flex;">
                            {% if publicacion['id_user'] == usuario['id'] %}
                            <form method="POST" action="{{ url_for('eliminar_publi') }}">
                                <input type="hidden" name="id_publi" value="{{ publicacion['id_publicacion'] }}">
                                <button type="submit"><i class="fa-solid fa-xmark"></i></button>
                            </form>

                            <button style="margin-left: 10px; font-size: medium;" onclick="activateUpdate(this)"><i class="fa-solid fa-pen-to-square"></i></button>

                        {% endif %}
                        </div>
                        </div>

                    <div class="container_text">

                        <form action="{{url_for('actualizar_publi')}}" method="POST" id="form_update_text">
                        <input type="hidden" name="id_publi" value="{{ publicacion['id_publicacion'] }}">

                        <div class="view_publication" >
                            <p class="text">{{ publicacion['contenido'] }}</p>
                        </div>
                            
                        <div class="edit_publication" style="display: none;">
                            <textarea name="contenido" id="contenido">{{ publicacion['contenido'] }}</textarea>
                            <div id="error_update_post" class="error_message"></div>
                            <button type="submit" id="button_save_post"> Guardar</button>
                            <button onclick="cancelUpdate(this)">Cancelar</button>  
                        </div>
                        </form>
                    </div>
                </div>

            {% endfor %}
            {%if publicaciones|length > 39 %}
            <a href="{{ url_for('home', page=page + 1) }}">Cargar más</a>
            {% else %}
            
            <div class="if_not_publication">
                Misión completada. No hay más contenido por descubrir... por ahora.
            </div>
            {% endif %}

        {% else %}
            
            <div class="if_not_publication">
                Ups... no hay nada por aqui
            </div>
        {% endif %}
            </div>
        </main>
        <aside class="right">
            <div class="container_stats">
                <p>publicaciones: {{stats['cant_publi']}}</p>
                <p>Seguidores: {{stats}}</p>
                <p>Siguiendo: {{stats['cant_seguidores']}}</p>
            </div>
            

        </aside>
    </div>
</body>
</html>